---
title: "11-Deseq2"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")

BiocManager::install("DESeq2")
```

```{r}
library(DESeq2)
browseVignettes("DESeq2")

```


```{r}
data <- read.table("analyses/Abundance-merge.txt", header = T, sep = "\t")
rownames(data) <- data$Feature
data <- data[,-1]
```


```{r}
head(data)
str(data)
```


```{r}
deseq2.colData <- data.frame(condition=factor(c(rep("un-infected", 4), rep("infected", 4))), 
                             type=factor(rep("single-read", 8)))
rownames(deseq2.colData) <- colnames(data)
deseq2.dds <- DESeqDataSetFromMatrix(countData = data,
                                     colData = deseq2.colData, 
                                     design = ~ condition)
```



